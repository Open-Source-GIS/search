<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title></title>
    <style type="text/css" media="all">
      /* <![CDATA[ */
body {
    border: 23px solid #898989;
    font-family: sans-serif;
    height: 100%;
    margin: 0;
    padding: 13px;
}
#search {
 background: none repeat scroll 0 0 #404040;
    color: #FFFFFF;
    margin: 0;
    padding: 21px;
}
      #results div {
	  margin: 17px 0;
	  width: 43em;
      }
      em {
	  font-style: normal;
	  font-weight: bold;
      }
      span.thumb {
	  display: inline-block;
	  height: 66px;
	  vertical-align: middle;
	  width: 86px;
      }
      span.thumb img {
	  border: 1px solid #595960;
	  box-shadow: 3px 3px 6px #9898B5;
      }
      span.sourceName {
	  display: inline-block;
	  border: 1px outset gray;
	  border-radius: 6px;
	  padding: 7px;
	  color: gray;
	  background: #DEDEDE;
	  margin-right: 15px;
      }
      a {
	  text-decoration: none;
	  color: default;
      } 
      /* ]]> */
    </style>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
    <script type="text/javascript">
      // <![CDATA[
$(function () {
    var sources = ["photo", "sfd", "drewblog", "chat"];
    function refresh(ev) {
	var q = $(this).val();
	$("#results").empty();
	if (!q) { 
	    return;
	}
	$.getJSON("search", {source: sources, q: q}, function (ret) { 
	    $("#results").empty();
	    $.each(ret, function (i, row) {
		var div = $("<div>");
		div.html(row.text);
		if (row.source == "photo") {
		    div.prepend($("<span>").addClass("thumb").append(
			$("<img>").attr("src", row.uri + "?size=thumb")));
		} else {
		    div.prepend($("<span>").addClass("sourceName")
				.text(row.source));
		}
		div.wrapInner($("<a>").attr("href", row.view || row.uri));
		$("#results").append(div);
	    });
	});
    }

    $.each(sources, function (i, s) {
	$("#sources").append($("<input>").attr({type: "checkbox", name: "source", value: s})).append(" "+s);
    });

    $("input[name=q]").change(refresh).keyup(refresh).focus();
    refresh();
});
      // ]]>
    </script>
  </head>
  <body>
    <div id="search">
      <div>Search: <input type="text" name="q"/></div>
      <div id="sources">Sources (checking these doesn't work yet): </div>
    </div>
    <div id="results">
    </div>
  </body>
</html>